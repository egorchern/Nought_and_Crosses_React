"use strict";var __extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();exports.__esModule=!0;var React=require("react"),react_dom_1=require("react-dom"),main=document.querySelector("#root");function copy_array(e){for(var t=[],r=0;r<e.length;r+=1){var n=typeof e[r],a=e[r];"object"==n&&(a=copy_array(a)),t.push(a)}return t}function generate_n_size_array(e,t){for(var r=[],n=0;n<e;n+=1){for(var a=[],o=0;o<e;o+=1)a.push(t);r.push(a)}return r}function check_game_state(e){for(var t=!0,r=e.length,n=e[0].length,a=generate_n_size_array(n,""),o=0;o<r;o+=1){for(var s=e[o],c=0,i=0,l=0;l<s.length;l+=1)a[l][o]=s[l],"X"===s[l]?c+=1:"O"===s[l]&&(i+=1);if(c===r)return"X";if(i===r)return"O"}for(var _=0;_<n;_+=1){for(var u=a[_],c=0,i=0,l=0;l<u.length;l+=1)"X"===u[l]?c+=1:"O"===u[l]?i+=1:t=!1;if(c===n)return"X";if(i===n)return"O"}for(var m=[],p=[],h=0;h<r;h+=1)p.push(e[h][h]);for(var f=[],d=0,v=n-1;d<r;d+=1)f.push(e[d][v]),--v;m.push(p),m.push(f);for(var y=0;y<2;y+=1){for(var b=m[y],c=0,i=0,l=0;l<b.length;l+=1)"X"===b[l]?c+=1:"O"===b[l]&&(i+=1);if(c===r)return"X";if(i===r)return"O"}return!0===t?"D":""}function get_possible_moves(e){for(var t=e.length,r=[],n=0;n<t;n+=1)for(var a,o=0;o<t;o+=1){""===e[n][o]&&(a=[n,o],r.push(a))}return r}function make_move_on_board(e,t,r){var n=copy_array(e);return n[t[0]][t[1]]=r,n}function minmax(e,t,r,n,a){switch(check_game_state(e)){case"X":return"X"===r?[1,a]:[-1,a];case"O":return"O"===r?[1,a]:[-1,a];case"D":return[0,a]}if(!0===t){for(var o=1/0,s=1/0,c=get_possible_moves(e),i=0;i<c.length;i+=1){var l=(m=minmax(make_move_on_board(e,c[i],n),!1,r,n,a+1))[0],_=m[1];l<o?(o=l,s=_):l===o&&_<s&&(s=_)}return[o,s]}for(var u=-1/0,s=1/0,c=get_possible_moves(e),i=0;i<c.length;i+=1){var m,l=(m=minmax(make_move_on_board(e,c[i],r),!0,r,n,a+1))[0],_=m[1];u<l?(u=l,s=_):l===u&&_<s&&(s=_)}return[u,s]}function select_best_move(e,t,r){for(var n,a=-1/0,o=1/0,s=get_possible_moves(e),c=0;c<s.length;c+=1){var i=s[c],l=minmax(make_move_on_board(e,i,t),!0,t,r,0),_=l[0],u=l[1];console.log(_,u),a<_?(a=_,n=i,o=u):_===a&&u<o&&(o=u,n=i)}return console.log("\n"),n}var Field_square=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.render=function(){var e=this.props.value;return!0===this.props.is_disabled?React.createElement("div",{className:"square_container disabled"},e):React.createElement("div",{className:"square_container",onClick:this.props.onClick},e)},e}(React.Component),Field=function(t){function e(e){var a=t.call(this,e)||this;return a.handle_click=function(e,t){var r,n=a.state.board;n[e][t]=a.turn,a.setState({board:n}),"X"===a.turn?a.turn="O":a.turn="X",a.game_state=check_game_state(n),""===a.game_state&&a.ai_symbol===a.turn&&(r=select_best_move(a.state.board,a.ai_symbol,a.player_symbol),a.handle_click(r[0],r[1]))},a.state={board:generate_n_size_array(a.props.size,"")},a.turn="X",a.player_symbol=a.props.player_symbol,a.ai_symbol=a.props.ai_symbol,a.game_state="",a}return __extends(e,t),e.prototype.componentDidMount=function(){var e;"X"===this.ai_symbol&&(e=select_best_move(this.state.board,this.ai_symbol,this.player_symbol),this.handle_click(e[0],e[1]))},e.prototype.render=function(){var o=this,e=this.state.board.map(function(e,t){var a=t;return React.createElement("div",{key:a,className:"field_row"},e.map(function(e,t){var r=t,n=""!=e||""!=o.game_state;return React.createElement(Field_square,{key:r,value:e,is_disabled:n,onClick:function(){return o.handle_click(a,r)}})}))}),t="Next turn: "+this.turn;return""!=this.game_state&&(t=this.game_state+" won!"),"D"===this.game_state&&(t="Draw!"),React.createElement("div",{className:"field_container"},React.createElement("h2",null,t),e)},e}(React.Component),Symbol_choose_menu=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.render=function(){var e=this;return React.createElement("div",null,React.createElement("div",null,React.createElement("span",{id:"choose_menu_heading"},"Choose what symbol you play as")),React.createElement("div",{className:"choose_menu"},React.createElement("div",{onClick:function(){return e.props.onClick("X")},className:"choose_menu_button"},React.createElement("span",null,"X")),React.createElement("div",{onClick:function(){return e.props.onClick("O")},className:"choose_menu_button"},React.createElement("span",null,"O"))))},e}(React.Component),App=function(r){function e(e){var t=r.call(this,e)||this;return t.handle_symbol_choose_click=function(e){t.player_symbol=e,t.ai_symbol="X"===e?"O":"X",t.setState({menu_enabled:!1})},t.state={menu_enabled:!0},t.player_symbol,t.ai_symbol,t.field_size=3,t}return __extends(e,r),e.prototype.render=function(){var e=this.state.menu_enabled;return React.createElement("div",{className:"app_container"},!0===e&&React.createElement(Symbol_choose_menu,{onClick:this.handle_symbol_choose_click}),!1===e&&React.createElement("div",{className:"game_container"},React.createElement(Field,{size:this.field_size,player_symbol:this.player_symbol,ai_symbol:this.ai_symbol})))},e}(React.Component);react_dom_1.render(React.createElement(App,null),main);